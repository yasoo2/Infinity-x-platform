
// @ts-check

import globals from "globals";
import pluginJs from "@eslint/js";
import pluginReactConfig from "eslint-plugin-react/configs/recommended.js";
import reactHooks from 'eslint-plugin-react-hooks';
import reactRefresh from 'eslint-plugin-react-refresh';

/** @type {import('eslint').Linter.FlatConfig[]} */
export default [
  // 1. Global ignores
  {
    ignores: [
      "**/dist/**",
      "**/node_modules/**",
      "public-site/assets/**",
      ".idx/**",
    ],
  },

  // 2. Base configuration for all JS/MJS/CJS files
  {
    files: ["**/*.{js,mjs,cjs}"],
    ...pluginJs.configs.recommended,
  },

  // 3. Backend, worker, and root file configuration (Node.js environment)
  {
    files: ["backend/**/*.js", "backend/**/*.mjs", "worker/**/*.mjs", "*.mjs"],
    languageOptions: {
      globals: {
        ...globals.node,
      },
    },
    rules: {
      "no-unused-vars": ["warn", { "args": "none" }],
    }
  },

  // 4. Frontend configuration for dashboard-x (React/JSX)
  {
    files: ["dashboard-x/src/**/*.{js,jsx}"],
    ...pluginReactConfig,
    languageOptions: {
      ...pluginReactConfig.languageOptions,
      globals: {
        ...globals.browser,
      },
    },
    settings: {
      react: {
        version: "detect",
      },
    },
    plugins: {
      "react-hooks": reactHooks,
      "react-refresh": reactRefresh,
    },
    rules: {
      ...pluginReactConfig.rules,
      ...reactHooks.configs.recommended.rules,
      "react/react-in-jsx-scope": "off",
      "react/jsx-uses-react": "off",
      "react/prop-types": "off",
      "react-refresh/only-export-components": "warn",
       "no-unused-vars": ["warn", { "varsIgnorePattern": "^[A-Z_]", "args": "none" }],
    },
  },
  
  // 5. Global overrides for specific errors that need fixing across the board
  {
      rules: {
        "no-undef": "error"
      }
  }
];
