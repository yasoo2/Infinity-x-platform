/**\n * ðŸ”¬ Intelligent Reviewer Tool - Now as a Dynamic Function\n * @version 2.0.0\n * This tool leverages an AI model to perform an intelligent, context-aware review of code snippets.\n * It has been refactored to be a standalone, metadata-annotated function for dynamic discovery by the ToolManager.\n */\nimport OpenAI from \'openai\';\n\n// --- AI Configuration ---\nconst openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\nconst REVIEW_MODEL = \'gpt-4-turbo\'; // Using a powerful and efficient model for code analysis\n\n// --- The Tool Function ---\n\nasync function reviewCode({ code, language, review_type = \'best_practices\' }) {\n    if (!process.env.OPENAI_API_KEY) {\n        return { success: false, error: \'OpenAI API key is not configured.\' };\n    }\n\n    const prompt = `As an expert code reviewer specializing in ${language}, please analyze the following code snippet. \nFocus on ${review_type.replace(/_/g, \' \')}. Provide your feedback in a concise, actionable, and professional manner. Structure your output as a list of specific points.\n\nCODE:\n\`\`\`${language}\n${code}\n\`\`\`\n\nProvide only the review feedback.`;\n\n    try {\n        const response = await openai.chat.completions.create({\n            model: REVIEW_MODEL,\n            messages: [{ role: \'user\', content: prompt }],\n            temperature: 0.5,\n            max_tokens: 1000,\n            top_p: 1,\n            frequency_penalty: 0,\n            presence_penalty: 0,\n        });\n\n        const feedback = response.choices[0].message.content.trim();\n        return { success: true, feedback };\n\n    } catch (error) {\n        console.error(`[IntelligentReviewer] AI review failed:`, error);\n        return { success: false, error: `AI code review failed: ${error.message}` };\n    }\n}\n\n// --- Metadata for Dynamic Discovery ---\n\nreviewCode.metadata = {\n    name: \"reviewCode\",\n    description: \"Performs an AI-powered code review on a given code snippet. Can check for best practices, security vulnerabilities, or performance issues.\",\n    parameters: {\n        type: \"object\",\n        properties: {\n            code: {\n                type: \"string\",\n                description: \"The raw source code to be reviewed.\"\n            },\n            language: {\n                type: \"string\",\n                description: \"The programming language of the code (e.g., \'javascript\', \'python\').\"\n            },\n            review_type: {\n                type: \"string\",\n                description: \"The type of review to perform.\",\n                enum: [\"best_practices\", \"security_vulnerabilities\", \"performance_optimization\", \"documentation_and_clarity\"]\n            }\n        },\n        required: [\"code\", \"language\", \"review_type\"]\n    }\n};\n\n// --- Exporting the tool in the expected format ---\n\nexport default { reviewCode };\n