/**\n * Smart Page Builder Engine - UPGRADED\n * Now powered by a professional-grade prompt for generating complete, production-ready web pages.\n */\n\nimport { OpenAI } from \'openai\';\nimport { promises as fs } from \'fs\';\n\nexport class SmartPageBuilder {\n  constructor(config) {\n    this.config = config;\n    this.openai = new OpenAI({ apiKey: config.openaiApiKey });\n    this.model = \'gpt-4o\'; // Upgraded model for better results\n  }\n\n  /**\n   * Builds a complete, production-ready web page from a textual description.\n   * This method uses a highly detailed prompt to ensure quality, responsiveness, SEO, and performance.\n   * @param {string} description The detailed description of the desired web page.\n   * @param {string} filePath The path where the generated HTML file should be saved.\n   * @param {string} style The visual style (e.g., \'modern\', \'minimalist\').\n   * @returns {Promise<object>} An object containing the status and the generated code.\n   */\n  async buildPageFromDescription(description, filePath, style = \'modern\') {\n    console.log(`\\nğŸ¨ Building smart page: ${description}`);\n\n    const prompt = `\nØ£Ù†Øª **Ø¬Ùˆ (Joe)** â€” Ù…Ø·ÙˆØ± ÙˆÙŠØ¨ Ù…Ø­ØªØ±Ù Ù…ØªØ®ØµØµ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙˆØ§Ù‚Ø¹ Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©.\n\n**ğŸ¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:** Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙˆÙ‚Ø¹ ÙˆÙŠØ¨ ÙƒØ§Ù…Ù„\n\n**ğŸ“ Ø§Ù„ÙˆØµÙ:** ${description}\n\n**ğŸ¨ Ø§Ù„Ù†Ù…Ø·:** ${style}\n\n**ğŸ“‹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ© (CRITICAL):**\n1.  **Ù…Ù„Ù HTML ÙˆØ§Ø­Ø¯ ÙƒØ§Ù…Ù„** Ù…Ø¹ CSS Ùˆ JavaScript Ù…Ø¶Ù…Ù‘Ù†ÙŠÙ†.\n2.  **ØªØµÙ…ÙŠÙ… Ø­Ø¯ÙŠØ« ÙˆØ§Ø­ØªØ±Ø§ÙÙŠ** ÙŠØ¹ÙƒØ³ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.\n3.  **Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Responsive)** Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Mobile, Tablet, Desktop).\n4.  **Ø§Ø³ØªØ®Ø¯Ø§Ù… Tailwind CSS Ø¹Ø¨Ø± CDN** (Ù„Ø§ ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ù„ÙŠ).\n5.  **Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© Ø³Ù„Ø³Ø© (Smooth Animations)** Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… CSS/JS.\n6.  **ØªØ­Ø³ÙŠÙ† SEO:** Meta tags, Semantic HTML5, Alt text, Structured data.\n7.  **Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ:** ØªØ­Ù…ÙŠÙ„ Ø³Ø±ÙŠØ¹, ÙƒÙˆØ¯ Ù…Ø­Ø³Ù‘Ù†, Lazy loading Ù„Ù„ØµÙˆØ±.\n8.  **Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ (Accessibility):** ARIA labels, Keyboard navigation, Color contrast.\n9.  **Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¬Ù…ÙŠÙ„Ø©** (Ø§Ø³ØªØ®Ø¯Ù… Font Awesome Ø£Ùˆ Heroicons Ù…Ù† CDN).\n10. **ØªÙØ§Ø¹Ù„ÙŠØ©:** Ø£Ø²Ø±Ø§Ø±ØŒ Ù†Ù…Ø§Ø°Ø¬ØŒ Ù‚ÙˆØ§Ø¦Ù… ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„.\n\n**ğŸš« Ù…Ù…Ù†ÙˆØ¹:**\n- Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ± Ø®Ø§Ø±Ø¬ÙŠØ© (Ø§Ø³ØªØ®Ø¯Ù… placeholders Ù…Ù† placehold.co Ø£Ùˆ SVG Ù…Ø¶Ù…Ù†).\n- Ø±ÙˆØ§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠØ© Ù…ÙƒØ³ÙˆØ±Ø©.\n- ÙƒÙˆØ¯ ØºÙŠØ± Ù…ÙƒØªÙ…Ù„ Ø£Ùˆ \"...\".\n- ØªØ¹Ù„ÙŠÙ‚Ø§Øª TODO.\n\n**ğŸ“¤ Ø§Ù„Ø±Ø¯:**\nØ£Ø±Ø¬Ø¹ **ÙÙ‚Ø·** ÙƒÙˆØ¯ HTML Ø§Ù„ÙƒØ§Ù…Ù„ØŒ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø´Ø±Ø­ Ø£Ùˆ markdown. Ø§Ø¨Ø¯Ø£ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ù€: \`<!DOCTYPE html>\`\n`;\n\n    try {\n      const response = await this.openai.chat.completions.create({\n        model: this.model,\n        messages: [\n          { role: \'system\', content: \'You are a world-class web developer assistant.\' },\n          { role: \'user\', content: prompt }\n        ],\n        temperature: 0.4, // Slightly increased creativity for design\n      });\n\n      let generatedCode = response.choices[0].message.content.trim();\n\n      // Clean the code from any markdown fences\n      generatedCode = generatedCode.replace(/^```html\\n?|\\n?```$/g, \'\');\n\n      // Ensure the code starts correctly\n      if (!generatedCode.startsWith(\'<!DOCTYPE html>\')) {\n          generatedCode = \'<!DOCTYPE html>\\n\' + generatedCode;\n      }\n\n      console.log(`âœ… Page code generated successfully. Writing to file: ${filePath}`);\n\n      // Write the generated code to the specified file\n      await fs.writeFile(filePath, generatedCode);\n\n      return { \n        success: true, \n        filePath, \n        code: generatedCode,\n        message: `Page built and saved successfully to ${filePath}.`\n      };\n    } catch (error) {\n      console.error(\'âŒ Error in buildPageFromDescription:\', error.message);\n      return { success: false, message: `Failed to build page: ${error.message}` };\n    }\n  }\n}\n